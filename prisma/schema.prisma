generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model tbl_area {
  id_area   Int         @id @default(autoincrement())
  area      String      @db.VarChar(100)
  tbl_grupo tbl_grupo[]
}

model tbl_calendario {
  id_calendario Int         @id @default(autoincrement())
  nome_evento   String      @db.VarChar(100)
  data_evento   DateTime    @db.Date
  hora_evento   DateTime    @db.Time(0)
  descricao     String?     @db.Text
  link          String      @db.VarChar(500)
  id_usuario    Int
  tbl_usuario   tbl_usuario @relation(fields: [id_usuario], references: [id_usuario], onDelete: NoAction, onUpdate: NoAction, map: "fk_calendario_usuario")

  @@index([id_usuario], map: "fk_calendario_usuario")
}

model tbl_categoria {
  id_categoria         Int                    @id @default(autoincrement())
  categoria            String                 @db.VarChar(100)
  tbl_ebooks_categoria tbl_ebooks_categoria[]
}

model tbl_chat {
  id_chat                                        Int             @id @default(autoincrement())
  criado_em                                      DateTime        @db.Timestamp(0)
  remetente                                      Int
  destinatario                                   Int
  tbl_usuario_tbl_chat_destinatarioTotbl_usuario tbl_usuario     @relation("tbl_chat_destinatarioTotbl_usuario", fields: [destinatario], references: [id_usuario], onDelete: NoAction, onUpdate: NoAction, map: "fk_chat_destinatario")
  tbl_usuario_tbl_chat_remetenteTotbl_usuario    tbl_usuario     @relation("tbl_chat_remetenteTotbl_usuario", fields: [remetente], references: [id_usuario], onDelete: NoAction, onUpdate: NoAction, map: "fk_chat_remetente")
  tbl_mensagens                                  tbl_mensagens[]

  @@index([destinatario], map: "fk_chat_destinatario")
  @@index([remetente], map: "fk_chat_remetente")
}

model tbl_codigo_recuperacao {
  id        Int      @id @default(autoincrement())
  email     String   @db.VarChar(60)
  codigo    String   @db.VarChar(10)
  expiracao DateTime @db.DateTime(0)
}

model tbl_ebooks {
  id_ebooks            Int                    @id @default(autoincrement())
  titulo               String                 @db.VarChar(100)
  preco                Decimal                @db.Decimal(10, 2)
  descricao            String                 @db.Text
  link_imagem          String                 @db.VarChar(255)
  link_arquivo_pdf     String?                @db.VarChar(255)
  id_usuario           Int
  tbl_usuario          tbl_usuario            @relation(fields: [id_usuario], references: [id_usuario], onDelete: NoAction, onUpdate: NoAction, map: "fk_ebooks_usuario")
  tbl_ebooks_categoria tbl_ebooks_categoria[]

  @@index([id_usuario], map: "fk_ebooks_usuario")
}

model tbl_ebooks_categoria {
  id_ebooks_categoria Int           @id @default(autoincrement())
  id_categoria        Int
  id_ebooks           Int
  tbl_categoria       tbl_categoria @relation(fields: [id_categoria], references: [id_categoria], onDelete: Cascade, map: "fk_ebooks_categoria_categoria")
  tbl_ebooks          tbl_ebooks    @relation(fields: [id_ebooks], references: [id_ebooks], onDelete: Cascade, map: "fk_ebooks_categoria_ebooks")

  @@index([id_categoria], map: "fk_ebooks_categoria_categoria")
  @@index([id_ebooks], map: "fk_ebooks_categoria_ebooks")
}

model tbl_grupo {
  id_grupo          Int                 @id @default(autoincrement())
  nome              String              @db.VarChar(100)
  limite_membros    Int
  descricao         String              @db.Text
  imagem            String              @db.VarChar(255)
  id_area           Int
  id_usuario        Int
  tbl_area          tbl_area            @relation(fields: [id_area], references: [id_area], onDelete: NoAction, onUpdate: NoAction, map: "fk_grupo_area")
  tbl_usuario       tbl_usuario         @relation(fields: [id_usuario], references: [id_usuario], onDelete: NoAction, onUpdate: NoAction, map: "fk_grupo_usuario")
  tbl_usuario_grupo tbl_usuario_grupo[]

  @@index([id_area], map: "fk_grupo_area")
  @@index([id_usuario], map: "fk_grupo_usuario")
}

model tbl_mensagens {
  id_mensagens Int         @id @default(autoincrement())
  conteudo     String      @db.Text
  enviado_em   DateTime    @db.Timestamp(0)
  id_chat      Int
  id_usuario   Int
  tbl_chat     tbl_chat    @relation(fields: [id_chat], references: [id_chat], onDelete: NoAction, onUpdate: NoAction, map: "fk_mensagens_chat")
  tbl_usuario  tbl_usuario @relation(fields: [id_usuario], references: [id_usuario], onDelete: NoAction, onUpdate: NoAction, map: "fk_mensagens_usuario")

  @@index([id_chat], map: "fk_mensagens_chat")
  @@index([id_usuario], map: "fk_mensagens_usuario")
}

model tbl_usuario {
  id_usuario                                  Int                      @id @default(autoincrement())
  nome_completo                               String                   @db.VarChar(150)
  email                                       String                   @db.VarChar(100)
  data_nascimento                             DateTime?                @db.Date
  foto_perfil                                 String?                  @db.VarChar(255)
  descricao                                   String?                  @db.Text
  senha                                       String                   @db.VarChar(255)
  tipo_usuario                                tbl_usuario_tipo_usuario
  tbl_calendario                              tbl_calendario[]
  tbl_chat_tbl_chat_destinatarioTotbl_usuario tbl_chat[]               @relation("tbl_chat_destinatarioTotbl_usuario")
  tbl_chat_tbl_chat_remetenteTotbl_usuario    tbl_chat[]               @relation("tbl_chat_remetenteTotbl_usuario")
  tbl_ebooks                                  tbl_ebooks[]
  tbl_grupo                                   tbl_grupo[]
  tbl_mensagens                               tbl_mensagens[]
  tbl_usuario_grupo                           tbl_usuario_grupo[]
}

model tbl_usuario_grupo {
  id_usuario_grupo Int         @id @default(autoincrement())
  id_usuario       Int
  id_grupo         Int
  entrou_em        DateTime    @db.Timestamp(0)
  tbl_grupo        tbl_grupo   @relation(fields: [id_grupo], references: [id_grupo], onDelete: Cascade, map: "fk_usuario_grupo_grupo")
  tbl_usuario      tbl_usuario @relation(fields: [id_usuario], references: [id_usuario], onDelete: Cascade, map: "fk_usuario_grupo_usuario")

  @@index([id_grupo], map: "fk_usuario_grupo_grupo")
  @@index([id_usuario], map: "fk_usuario_grupo_usuario")
}

enum tbl_usuario_tipo_usuario {
  Profissional
  Estudante
}
